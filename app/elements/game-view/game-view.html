<!--
@license
Copyright (c) 2015 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->

<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/paper-button/paper-button.html">
<link rel="import" href="../game-constants/game-constants.html">
<link rel="import" href="../map-view/map-view.html">
<link rel="import" href="../encounter-view/encounter-view.html">

<dom-module id="game-view">
  <template>
    <game-constants id="constants"></game-constants>

    Turn: {{game.turn}}
    <br/> Current player: {{currentPlayerName(game.currentPlayer)}}
    <br/> Current phase: {{currentPhaseName(game.phase)}}
    <br/>

    <map-view hidden="{{!isMovementPhase(game.phase)}}" players="{{players}}" game="{{game}}"></map-view>
    <encounter-view hidden="{{!isEncounterPhase(game.phase)}}" game="{{game}}"></encounter-view>
  </template>
  <script>
    (function() {
      'use strict';

      Polymer({
        is: 'game-view',

        properties: {
          players: {
            type: Array
          },
          game: {
            type: Object,
            notify: true
          }
        },

        currentPlayerName: function(currentPlayer) {
          return this.players[currentPlayer].name;
        },

        currentPhaseName: function(phase) {
          return this.$.constants.phaseNames[phase];
        },

        nextPhase: function() {
          this.set('game.phase', this.game.phase + 1);
        },

        isMovementPhase: function(phase) {
          return phase === this.$.constants.phases.Movement;
        },

        isEncounterPhase: function(phase) {
          return phase === this.$.constants.phases.Encounter;
        }
      });
    })();
  </script>
</dom-module>
